{#
    This template uses Bootstraps OffCanvas markup.

    @see https://getbootstrap.com/docs/5.2/components/offcanvas
#}

{% sw_extends '@Storefront/storefront/utilities/offcanvas.html.twig' %}

{% set isAjaxOffcanvas = false %}

{% block utilities_offcanvas_meta %}
    {# only including this for robots to have appropriate meta tags and when offcanvas is loaded via ajax #}
    {% if not app.request.xmlHttpRequest and isAjaxOffcanvas %}
        {% sw_include '@Storefront/storefront/layout/meta.html.twig' %}
    {% endif %}
{% endblock %}

{% block utilities_offcanvas %}
    {% block utilities_offcanvas_header %}
        <div class="offcanvas-header">
            {% block utilities_offcanvas_close %}
                <button class="btn btn-light offcanvas-close js-offcanvas-close">
                    {% block utilities_offcanvas_close_icon %}
                        {% sw_icon 'x' style { size: 'sm' } %}
                    {% endblock %}

                    {% block utilities_offcanvas_close_text %}
                        {{ 'general.offcanvasCloseMenu'|trans|sw_sanitize }}
                    {% endblock %}
                </button>
            {% endblock %}
        </div>
    {% endblock %}

    {% block utilities_offcanvas_content_container %}
        <div class="offcanvas-body">
            {% block utilities_offcanvas_content %}{% endblock %}
        </div>
    {% endblock %}

{# new #}
    {% block component_offcanvas_cart_actions %}
        <div class="offcanvas-cart-actions">
            {% block component_offcanvas_cart_actions_promotion %}
                {% if isCartNotEmpty %}
                    <div class="js-offcanvas-cart-promotion">
                        {% block component_offcanvas_cart_actions_promotion_form %}
                            <form action="{{ path('frontend.checkout.promotion.add') }}"
                                    class="offcanvas-cart-promotion-form js-offcanvas-cart-add-promotion"
                                    method="post">
                                {% block component_offcanvas_cart_actions_promotion_redirect %}
                                    <input type="hidden"
                                            name="redirectTo"
                                            value="frontend.cart.offcanvas">
                                {% endblock %}

                                {% block component_offcanvas_cart_actions_promotion_input_group %}
                                    <div class="input-group">
                                        {% block component_offcanvas_cart_actions_promotion_label %}
                                            <label class="visually-hidden" for="addPromotionOffcanvasCartInput">
                                                {{ 'checkout.addPromotionLabel'|trans|sw_sanitize }}
                                            </label>
                                        {% endblock %}

                                        {% block component_offcanvas_cart_actions_promotion_input %}
                                            <input type="text"
                                                    name="code"
                                                    class="form-control"
                                                    id="addPromotionOffcanvasCartInput"
                                                    placeholder="{{ 'checkout.addPromotionPlaceholder'|trans|striptags }}"
                                                    aria-label="{{ 'checkout.addPromotionLabel'|trans|striptags }}"
                                                    aria-describedby="addPromotionOffcanvasCart"
                                                    required="required">
                                        {% endblock %}

                                        {% block component_offcanvas_cart_actions_promotion_submit %}
                                            <button class="btn btn-secondary"
                                                    type="submit"
                                                    id="addPromotionOffcanvasCart">
                                                {% sw_icon 'checkmark' %}
                                            </button>
                                        {% endblock %}
                                    </div>
                                {% endblock %}
                            </form>
                        {% endblock %}
                    </div>
                {% endif %}
            {% endblock %}

            {% block component_offcanvas_cart_actions_checkout %}
                <div class="d-grid">
                    <a href="{{ path('frontend.checkout.confirm.page') }}"
                        class="btn btn-primary begin-checkout-btn{% if isCartNotEmpty %} btn-primary{% else %} btn-light disabled{% endif %}"
                        title="{{ 'checkout.proceedToCheckout'|trans|striptags }}">
                        {{ 'checkout.proceedToCheckout'|trans|sw_sanitize }}
                    </a>
                </div>
            {% endblock %}

            {% block component_offcanvas_cart_actions_cart %}
                <div class="d-grid">
                    <a href="{{ path('frontend.checkout.cart.page') }}"
                        class="btn btn-primary"
                        title="{{ 'checkout.proceedToCart'|trans|striptags }}">
                        {{ 'checkout.proceedToCart'|trans|sw_sanitize }}
                    </a>
                </div>
            {% endblock %}
        </div>
    {% endblock %}
{% endblock %}
